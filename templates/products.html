{% extends "base.html" %}
{% block content %}
<h3>Manage Products</h3>

<form method="POST">
  {{ form.hidden_tag() }}
  <div class="mb-3">
    {{ form.name.label(class_='form-label') }}
    {{ form.name(class_='form-control') }}
  </div>
  <div class="mb-3">
    {{ form.price.label(class_='form-label') }}
    {{ form.price(class_='form-control') }}
  </div>
  <div class="mb-3">
    {{ form.stock.label(class_='form-label') }}
    {{ form.stock(class_='form-control') }}
  </div>
  <div class="mb-3">
    {{ form.category_id.label(class_='form-label') }}
    {{ form.category_id(class_='form-select') }}
  </div>
  <div class="text-end">
    {{ form.submit(class_='btn btn-success') }}
  </div>
</form>

<hr />

<h4>Existing Products</h4>
<table class="table table-bordered">
  <thead>
    <tr>
      <th>Name</th>
      <th>Price</th>
      <th>Stock</th>
      <th>Category</th>
      <th>Update Stock</th>
    </tr>
  </thead>
  <tbody>
    {% for product in products %}
    <tr>
      <td>{{ product.name }}</td>
      <td>{{ product.price }}</td>
      <td>{{ product.stock }}</td>
      <td>{{ product.category.name if product.category else 'No Category' }}</td>
      <td>
        <form action="{{ url_for('update_stock', product_id=product.id) }}" method="POST" class="d-inline">
          <input type="number" name="stock" value="{{ product.stock }}" class="form-control d-inline-block" style="width:70px;">
          <button type="submit" class="btn btn-primary btn-sm">Update</button>
        </form>
      </td>
    </tr>
    {% endfor %}
    {% if products|length == 0 %}
    <tr>
      <td colspan="5">No products found.</td>
    </tr>
    {% endif %}
  </tbody>
</table>
{% endblock %}

